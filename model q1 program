import pandas as pd
import time
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder
from sklearn.metrics import accuracy_score
from sklearn.tree import DecisionTreeClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.neighbors import KNeighborsClassifier

# Load dataset
df = pd.read_csv("iris.csv")

# Split features and target
X = df.drop("species", axis=1)
y = df["species"]

# Encode target labels
le = LabelEncoder()
y = le.fit_transform(y)

# Train-test split
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

models = {
    "Decision Tree": DecisionTreeClassifier(),
    "Logistic Regression": LogisticRegression(max_iter=200),
    "KNN Classifier": KNeighborsClassifier()
}

results = []

# Train and evaluate each model
for name, model in models.items():
    start = time.time()
    model.fit(X_train, y_train)
    end = time.time()

    predictions = model.predict(X_test)
    accuracy = accuracy_score(y_test, predictions)
    speed = end - start

    results.append([name, accuracy, speed])

# Display results
result_df = pd.DataFrame(results, columns=["Model", "Accuracy", "Execution Time (s)"])
print(result_df)
